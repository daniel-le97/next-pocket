"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[568],{20128:function(e,s,t){var a=t(85893);let r=e=>{let{avatarUrl:s,width:t,height:r}=e;return(0,a.jsx)("img",{src:s,alt:"User Avatar",className:"rounded-full ".concat(t," ").concat(r," object-cover ")})};s.Z=r},59719:function(e,s,t){t.d(s,{Z:function(){return P}});var a=t(85893),r=t(50828),i=t(18532),n=t(3688),l=t(85699),c=t(61528),o=t(63750),d=t(79790);let u=e=>{let{messageId:s}=e,t=async()=>{try{let e=await d.Z.confirm();if(!e)return;await l.lt.deleteMessage(s)}catch(e){d.Z.error(e)}};return(0,a.jsx)("div",{className:"message-options-icon  group/item ",onClick:t,children:(0,a.jsx)(c.ZP,{placement:"top",color:"invert",content:"Delete",children:(0,a.jsx)(o.Ovj,{size:22})})})};var m=(0,r.Pi)(u),h=t(87536),g=t(44080),x=t(84536),p=t(67294),v=t(89583),j=t(50229);let f=e=>{let{message:s}=e;return(0,a.jsx)("div",{className:"message-options-icon  group/item",children:(0,a.jsx)(c.ZP,{content:"Edit",placement:"top",color:"invert",children:(0,a.jsx)(b,{message:s})})})},b=e=>{var s,t,r;let{message:i}=e,[c,o]=(0,p.useState)(!1),d=e=>{var s;null!==(s=e.content)&&void 0!==s&&s.includes(" *(edited)*")||(e.content+=" *(edited)*")},{register:u,handleSubmit:m}=(0,h.cI)({defaultValues:{content:null===(s=i.content)||void 0===s?void 0:s.replace(" *(edited)*",""),user:i.user.id,channel:null===(t=j.a.activeChannel)||void 0===t?void 0:t.id}}),f=async e=>{try{d(e),await l.lt.editMessage(i.id,e),o(!1)}catch(e){console.error("Edit Message",e)}};return(0,a.jsxs)("div",{className:"  group ",children:[(0,a.jsx)(v.fmQ,{size:22,onClick:()=>{o(!0)}}),(0,a.jsx)(g.u,{appear:!0,show:c,as:p.Fragment,children:(0,a.jsxs)(x.V,{as:"div",className:"relative z-10",onClose:()=>{o(!1)},children:[(0,a.jsx)(g.u.Child,{as:p.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,a.jsx)(g.u.Child,{as:p.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(x.V.Panel,{className:"  w-full max-w-screen-md rounded-md bg-zinc-900 p-2",children:[(0,a.jsxs)(x.V.Title,{as:"h3",className:"dialog-title",children:["Edit Message ",i.id]}),(0,a.jsxs)("form",{onSubmit:m(f),className:"create-server-form",children:[(0,a.jsx)("div",{className:"rounded-sm bg-zinc-800",children:(0,a.jsxs)("div",{className:"message group",children:[(0,a.jsx)("div",{className:"relative m-0 ml-auto mb-auto flex w-12 flex-col items-center",children:(0,a.jsx)("img",{className:"mx-0  mb-auto mt-0 h-12 w-12  cursor-pointer rounded-full bg-gray-100 object-cover object-top shadow-md shadow-zinc-500 dark:shadow-zinc-800",src:i.user.avatarUrl||"https://api.dicebear.com/5.x/bottts-neutral/svg",alt:"avatar",width:"40px"})}),(0,a.jsxs)("div",{className:"ml-auto flex w-4/5 flex-col items-start",children:[(0,a.jsxs)("p",{className:" font-bold  text-red-500",children:[null===(r=i.user)||void 0===r?void 0:r.username,(0,a.jsx)("small",{className:"ml-3 font-normal text-black dark:text-gray-300",children:(0,a.jsx)(n.Z,{datetime:i.created,locale:"en-US",style:{margin:5}})})]}),(0,a.jsx)("p",{className:"text-lg font-semibold dark:text-gray-300",children:(0,a.jsx)("textarea",{...u("content",{required:!0,minLength:1}),rows:4,cols:50,className:"peer m-2 block min-h-[auto] w-full rounded border-0 bg-zinc-700/20  py-[0.32rem] px-3 leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none dark:text-neutral-200 dark:placeholder:text-neutral-200 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0 "})})]})]})}),(0,a.jsxs)("div",{className:" flex gap-x-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>o(!1),className:"rounded-md bg-purple-500 p-2 font-bold text-zinc-300 hover:bg-opacity-80",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"rounded-md bg-indigo-500 p-2 font-bold text-zinc-300 hover:bg-opacity-80",children:"Submit Edit"})]})]})]})})})})]})})]})};var w=(0,r.Pi)(f),y=t(79003);let N=e=>{let{messageId:s}=e,t=async()=>{try{await y.v.create(s)}catch(e){d.Z.error(e)}};return(0,a.jsx)("div",{className:"group/item message-options-icon",onClick:t,children:(0,a.jsx)(c.ZP,{content:"Like",color:"invert",placement:"Top",children:(0,a.jsx)(v.spm,{size:22})})})};var k=(0,r.Pi)(N),C=t(39234),Z=t(20128),z=t(8189),L=t(26671);let T=e=>{let{language:s,value:t}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(z.Z,{style:L.FE,language:null!=s?s:void 0,wrapLongLines:!0,showLineNumbers:!0,children:t})})},F=e=>{var s,t,r;let{message:l,index:c}=e,o=j.a.messageQuery,u=null!==(r=j.a.messageLikes[c])&&void 0!==r?r:null,h=()=>{navigator.clipboard.writeText(function(e){let s=/```([\s\S]*)```/.exec(e);return s?s[1]:e}(l.content)),d.Z.success("Copied To Clipboard")};return(0,a.jsxs)("div",{className:""!=o?" message-filtered group ":" message    group  ",children:[(0,a.jsx)("div",{className:"message-user-avatar-status ",children:(0,a.jsx)(Z.Z,{width:"w-12",height:"h-12",avatarUrl:l.user.avatarUrl})}),(0,a.jsxs)("div",{className:" message-content      ",children:[(0,a.jsxs)("p",{className:" font-bold  text-red-500",children:[null===(s=l.user)||void 0===s?void 0:s.username,(0,a.jsx)("small",{className:"message-timestamp",children:(0,a.jsx)(n.Z,{datetime:l.created,locale:"en-US",style:{margin:5}})})]}),(0,a.jsx)(i.D,{children:l.content,className:"markdown",rehypePlugins:[C.Z],components:{code:e=>{let{inline:s,className:t,children:r,...i}=e;return s?(0,a.jsx)("code",{className:"whitespace-normal text-zinc-300",children:r}):(0,a.jsxs)("div",{className:"markdown-container ",children:[(0,a.jsx)("div",{className:" markdown-banner ",children:(0,a.jsx)("button",{onClick:h,className:"markdown-copy-btn",children:"Copy"})}),(0,a.jsx)(T,{language:t&&t.replace(/language-/,""),value:r,...i})]})}}}),(null==u?void 0:u.length)>=1&&(0,a.jsx)(M,{likes:u})]}),0===c&&(0,a.jsx)(E,{}),(0,a.jsx)("div",{className:"message-options",children:(0,a.jsx)("div",{className:"message-options-container",children:(null===(t=j.a.user)||void 0===t?void 0:t.id)==l.user.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w,{message:l}),(0,a.jsx)(m,{messageId:l.id})]}):(0,a.jsx)(k,{messageId:l.id})})})]})},E=()=>(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:" newest-message",children:(0,a.jsxs)("div",{className:"newest-message-container",children:["Newest Message",(0,a.jsx)("hr",{className:"  newest-message-line"})]})})}),M=e=>{let{likes:s}=e;return(0,a.jsx)(c.ZP,{content:(0,a.jsxs)("div",{className:"message-like-tooltip-container",children:[(0,a.jsx)("img",{src:"https://cdn-icons-png.flaticon.com/512/1533/1533908.png",alt:"Thumbs Up Icon",className:"h-10 w-10 rounded-full"}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:" w-full text-lg font-bold  text-indigo-400",children:"Thumbs Up By"}),(0,a.jsx)("div",{className:"flex flex-col overflow-y-scroll  ",children:s&&s.map((e,s)=>(0,a.jsx)("div",{className:" my-0.5 cursor-pointer rounded p-0.5 transition-all hover:bg-indigo-900 hover:text-gray-100 hover:shadow-sm hover:shadow-indigo-300 ",onClick:()=>{navigator.clipboard.writeText(e.expand.user.username),d.Z.success("Copied To Clipboard")},children:e.expand.user.username},s))})]})]}),color:"invert",children:(0,a.jsxs)("div",{className:"message-like-container group/like",children:[(0,a.jsx)("img",{src:"https://cdn-icons-png.flaticon.com/512/1533/1533908.png",alt:"Thumbs Up Icon",className:"h-6 w-6 rounded-full"}),null==s?void 0:s.length]})})};var P=(0,r.Pi)(F)},37066:function(e,s,t){t.d(s,{Z:function(){return n}});var a=t(85893),r=t(67294),i=t(89583);function n(e){let{isOnline:s}=e,[t,n]=(0,r.useState)(null);return(0,r.useEffect)(()=>{},[]),(0,a.jsx)("div",{className:"absolute right-0 bottom-0 rounded-full border-4 border-zinc-700 shadow-md shadow-zinc-700 ",children:s?(0,a.jsx)(i.gbA,{color:"#22c55e",size:10}):(0,a.jsx)(i.gbA,{color:"#ef4444",size:10})})}},73560:function(e,s,t){t.d(s,{Q:function(){return l},k:function(){return o}});var a=t(85893),r=t(11163),i=t(67294),n=t(50229);let l=e=>{let s=s=>{let t=(0,r.useRouter)(),l=n.a.user,c=async()=>{if(!l)return n.a.lastPath=t.asPath,t.push("/login")};return(0,i.useEffect)(()=>{c()},[t]),(0,a.jsx)(e,{...s})};return s};t(72770);var c=t(85699);let o=e=>{let s=s=>{let t=(0,r.useRouter)(),l=t.query.id||n.a.lastQueryId,o=n.a.user,[d,u]=(0,i.useState)(!1),m=async()=>{let e=await c.Cd.getUserMemberRecord({user:null==o?void 0:o.id,server:l});u(!!e)};return((0,i.useEffect)(()=>{l&&m()},[l]),!1===d)?(0,a.jsx)("div",{children:"please join the server before trying"}):(0,a.jsx)(e,{...s})};return s}},79003:function(e,s,t){t.d(s,{v:function(){return c}});var a=t(50229),r=t(68949),i=t(34625),n=t(59795);class l extends n.b{update(e){throw Error("Method not implemented.")}async getById(e){let s=a.a.user.id,t=await this.pb.getList(1,1,{filter:'message = "'.concat(e,'" && user = "').concat(s,'"')});return t.items[0]}async getOne(e){return this.pb.getOne(e,{expand:"user"})}getAll(){throw Error("Method not implemented.")}async delete(e,s){await this.pb.delete(s),console.log("likeService.delete()")}async create(e){let s=await this.getById(e);if(s){let t=s.id;await this.delete(e,t);return}let t={message:e,user:this.user.id};await this.pb.create(t,{expand:"user"}),console.log("likeService.create()")}async subscribe(){let e=await this.pb.subscribe("*",async e=>{let{action:s,record:t}=e,r=a.a.messages.findIndex(e=>e.id==t.message);if(-1==r){i.k.log("likeService.subscribe() message not found",t.message);return}if("delete"!==s){let e=await this.getOne(t.id);this.addLikeOrReplaceToMessage(e,r)}"delete"===s&&(this.filterLikeFromMessage(t,r),console.log("likeService.subscribe(delete)",t))});return e}addLikeOrReplaceToMessage(e,s){let t=a.a.messageLikes[s],i=null==t?void 0:t.findIndex(s=>s.id==e.id);t&&void 0!=i&&(0,r.aD)(()=>{if(-1==i){a.a.messageLikes[s]=[...t,e];return}t[i]=e})()}filterLikeFromMessage(e,s){let t=a.a.messageLikes[s];t&&(0,r.aD)(()=>{a.a.messageLikes[s]=t.filter(s=>s.id!=e.id)})()}}let c=new l("Likes")}}]);