"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[184],{126:function(e,s,a){a.d(s,{Z:function(){return F}});var t=a(85893),l=a(50828),i=a(18532),n=a(3688),r=a(85699),c=a(61528),o=a(63750),d=a(79790);let m=e=>{let{messageId:s}=e,a=async()=>{try{let e=await d.Z.confirm();if(!e)return;await r.lt.deleteMessage(s)}catch(e){d.Z.error(e)}};return(0,t.jsx)("div",{className:"message-options-icon  group/item ",onClick:a,children:(0,t.jsx)(c.ZP,{placement:"top",color:"invert",content:"Delete",children:(0,t.jsx)(o.Ovj,{size:22})})})};var u=(0,l.Pi)(m),g=a(87536),h=a(44080),x=a(84536),p=a(67294),v=a(89583),j=a(50229);let f=e=>{let{message:s}=e;return(0,t.jsx)("div",{className:"message-options-icon  group/item",children:(0,t.jsx)(c.ZP,{content:"Edit",placement:"top",color:"invert",children:(0,t.jsx)(b,{message:s})})})},b=e=>{var s,a,l;let{message:i}=e,[c,o]=(0,p.useState)(!1),d=e=>{var s;null!==(s=e.content)&&void 0!==s&&s.includes(" *(edited)*")||(e.content+=" *(edited)*")},{register:m,handleSubmit:u}=(0,g.cI)({defaultValues:{content:null===(s=i.content)||void 0===s?void 0:s.replace(" *(edited)*",""),user:i.user.id,channel:null===(a=j.a.activeChannel)||void 0===a?void 0:a.id}}),f=async e=>{try{d(e),await r.lt.editMessage(i.id,e),o(!1)}catch(e){console.error("Edit Message",e)}};return(0,t.jsxs)("div",{className:"  group ",children:[(0,t.jsx)(v.fmQ,{size:22,onClick:()=>{o(!0)}}),(0,t.jsx)(h.u,{appear:!0,show:c,as:p.Fragment,children:(0,t.jsxs)(x.V,{as:"div",className:"relative z-10",onClose:()=>{o(!1)},children:[(0,t.jsx)(h.u.Child,{as:p.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,t.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,t.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,t.jsx)(h.u.Child,{as:p.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,t.jsxs)(x.V.Panel,{className:"  w-full max-w-screen-md rounded-md bg-zinc-900 p-2",children:[(0,t.jsxs)(x.V.Title,{as:"h3",className:"dialog-title",children:["Edit Message ",i.id]}),(0,t.jsxs)("form",{onSubmit:u(f),className:"create-server-form",children:[(0,t.jsx)("div",{className:"rounded-sm bg-zinc-800",children:(0,t.jsxs)("div",{className:"message group",children:[(0,t.jsx)("div",{className:"relative m-0 ml-auto mb-auto flex w-12 flex-col items-center",children:(0,t.jsx)("img",{className:"mx-0  mb-auto mt-0 h-12 w-12  cursor-pointer rounded-full bg-gray-100 object-cover object-top shadow-md shadow-zinc-500 dark:shadow-zinc-800",src:i.user.avatarUrl||"https://api.dicebear.com/5.x/bottts-neutral/svg",alt:"avatar",width:"40px"})}),(0,t.jsxs)("div",{className:"ml-auto flex w-4/5 flex-col items-start",children:[(0,t.jsxs)("p",{className:" font-bold  text-red-500",children:[null===(l=i.user)||void 0===l?void 0:l.username,(0,t.jsx)("small",{className:"ml-3 font-normal text-black dark:text-gray-300",children:(0,t.jsx)(n.Z,{datetime:i.created,locale:"en-US",style:{margin:5}})})]}),(0,t.jsx)("p",{className:"text-lg font-semibold dark:text-gray-300",children:(0,t.jsx)("textarea",{...m("content",{required:!0,minLength:1}),rows:4,cols:50,className:"peer m-2 block min-h-[auto] w-full rounded border-0 bg-zinc-700/20  py-[0.32rem] px-3 leading-[1.6] outline-none transition-all duration-200 ease-linear focus:placeholder:opacity-100 data-[te-input-state-active]:placeholder:opacity-100 motion-reduce:transition-none dark:text-neutral-200 dark:placeholder:text-neutral-200 [&:not([data-te-input-placeholder-active])]:placeholder:opacity-0 "})})]})]})}),(0,t.jsxs)("div",{className:" flex gap-x-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>o(!1),className:"rounded-md bg-purple-500 p-2 font-bold text-zinc-300 hover:bg-opacity-80",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"rounded-md bg-indigo-500 p-2 font-bold text-zinc-300 hover:bg-opacity-80",children:"Submit Edit"})]})]})]})})})})]})})]})};var w=(0,l.Pi)(f),N=a(79003);let y=e=>{let{messageId:s}=e,a=async()=>{try{await N.v.create(s)}catch(e){d.Z.error(e)}};return(0,t.jsx)("div",{className:"group/item message-options-icon",onClick:a,children:(0,t.jsx)(c.ZP,{content:"Like",color:"invert",placement:"Top",children:(0,t.jsx)(v.spm,{size:22})})})};var k=(0,l.Pi)(y),L=a(39234),Z=a(20128),C=a(21154);let P=e=>{var s,a,l;let{message:r,index:c}=e,o=j.a.messageQuery,m=null!==(l=j.a.messageLikes[c])&&void 0!==l?l:null,g=()=>{navigator.clipboard.writeText(function(e){let s=/```([\s\S]*)```/.exec(e);return s?s[1]:e}(r.content)),d.Z.success("Copied To Clipboard")};return(0,t.jsxs)("div",{className:""!=o?" message-filtered group ":" message    group  ",children:[(0,t.jsx)("div",{className:"message-user-avatar-status ",children:(0,t.jsx)(Z.Z,{width:"w-12",height:"h-12",avatarUrl:r.user.avatarUrl})}),(0,t.jsxs)("div",{className:" message-content      ",children:[(0,t.jsxs)("p",{className:" font-bold  text-red-500",children:[null===(s=r.user)||void 0===s?void 0:s.username,(0,t.jsx)("small",{className:"message-timestamp",children:(0,t.jsx)(n.Z,{datetime:r.created,locale:"en-US",style:{margin:5}})})]}),(0,t.jsx)(i.D,{children:r.content,className:"markdown",rehypePlugins:[L.Z],linkTarget:"_blank",components:{code:e=>{let{inline:s,className:a,children:l,...i}=e;return s?(0,t.jsx)("code",{className:"whitespace-normal text-gray-600 dark:text-zinc-300",children:l}):(0,t.jsxs)("div",{className:"markdown-container ",children:[(0,t.jsxs)("div",{className:" markdown-banner ",children:[(0,t.jsx)("span",{className:"language-label",children:a}),(0,t.jsx)("button",{onClick:g,className:"markdown-copy-btn",children:"Copy"})]}),(0,t.jsx)(C.Z,{language:a&&a.replace(/language-/,""),value:l,...i})]})}}}),(null==m?void 0:m.length)>=1&&(0,t.jsx)(D,{likes:m})]}),0===c&&(0,t.jsx)(T,{}),(0,t.jsx)("div",{className:"message-options",children:(0,t.jsx)("div",{className:"message-options-container",children:(null===(a=j.a.user)||void 0===a?void 0:a.id)==r.user.id?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w,{message:r}),(0,t.jsx)(u,{messageId:r.id})]}):(0,t.jsx)(k,{messageId:r.id})})})]})},T=()=>(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{className:" newest-message",children:(0,t.jsxs)("div",{className:"newest-message-container",children:["Newest Message",(0,t.jsx)("hr",{className:"  newest-message-line"})]})})}),D=e=>{let{likes:s}=e;return(0,t.jsx)(c.ZP,{content:(0,t.jsxs)("div",{className:"message-like-tooltip-container",children:[(0,t.jsx)("img",{src:"https://cdn-icons-png.flaticon.com/512/1533/1533908.png",alt:"Thumbs Up Icon",className:"h-10 w-10 rounded-full"}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("div",{className:" w-full text-lg font-bold  text-indigo-400",children:"Thumbs Up By"}),(0,t.jsx)("div",{className:"flex flex-col overflow-y-scroll  ",children:s&&s.map((e,s)=>(0,t.jsx)("div",{className:" my-0.5  rounded p-0.5 transition-all  hover:text-gray-100 hover:text-shadow  ",children:e.expand.user.username},s))})]})]}),color:"invert",children:(0,t.jsxs)("div",{className:"message-like-container group/like",children:[(0,t.jsx)("img",{src:"https://cdn-icons-png.flaticon.com/512/1533/1533908.png",alt:"Thumbs Up Icon",className:"h-6 w-6 rounded-full"}),null==s?void 0:s.length]})})};var F=(0,l.Pi)(P)},50184:function(e,s,a){a.d(s,{Y:function(){return g}});var t=a(85893),l=a(79003),i=a(50828),n=a(67294),r=a(58533),c=a(79790),o=a(50229),d=a(45445),m=a(126);let u=()=>{let e,s;async function a(){var e;console.log(o.a.page,o.a.totalPages);let s=null===(e=o.a.activeChannel)||void 0===e?void 0:e.id;o.a.page++,await d.l.getMessagesByChannelId(s),console.log("page",o.a.page,"totalPage",o.a.totalPages)}return(0,n.useEffect)(()=>((async()=>{try{console.log(o.a.page,o.a.totalPages),e=await d.l.subscribe(),s=await l.v.subscribe()}catch(e){c.Z.error(e,"like or message subscription failed")}})(),()=>{null==s||s(),null==e||e()}),[]),(0,t.jsxs)("div",{id:"scrollableDiv",className:"flex h-full  flex-col-reverse overflow-auto pb-32 pt-6  ".concat(""!=o.a.messageQuery?"rounded-sm border-2 border-indigo-500 shadow-inner  ":" "),children:[o.a.messages.length>=1&&(0,t.jsx)(r.Z,{dataLength:o.a.messages.length,next:a,className:"flex flex-col-reverse pt-6    ",inverse:!0,hasMore:o.a.totalPages!=o.a.page,loader:(0,t.jsx)(g,{}),scrollableTarget:"scrollableDiv",children:o.a.messages.map((e,s)=>{let a=new Date(e.created).toLocaleDateString(),l=new Date(Date.now()).toLocaleDateString(),i=s>0?new Date(o.a.messages[s-1].created).toLocaleDateString():null;return(0,t.jsxs)("div",{children:[(0,t.jsx)(m.Z,{index:s,message:e}),(0,t.jsx)("div",{children:a!==i&&a!==l&&(0,t.jsxs)("div",{className:"new-date",children:[(0,t.jsx)("hr",{className:"w-3/6  opacity-40"}),(0,t.jsx)("div",{className:" new-date-text",children:a}),(0,t.jsx)("hr",{className:"w-3/6  opacity-40"})]})})]},s)})}),""==o.a.messageQuery&&0==o.a.messages.length&&(0,t.jsx)(g,{}),""!=o.a.messageQuery&&0==o.a.messages.length&&(0,t.jsxs)("div",{className:"container w-1/2 rounded  p-3 text-center text-xl text-gray-400",children:["No messages contain",(0,t.jsx)("br",{}),(0,t.jsxs)("div",{className:"font-bold text-gray-200 my-2",children:['"',o.a.messageQuery,'"']}),"Refine Your search"]})]})},g=()=>(0,t.jsx)("div",{className:"fixed inset-0 h-1",children:(0,t.jsx)("div",{className:"relative h-1 w-full overflow-hidden rounded-lg shadow  ",children:(0,t.jsx)("div",{className:"animate-loader   absolute inset-0 bg-gradient-to-r from-indigo-400 to-indigo-500 shadow-md shadow-indigo-500  "})})});s.Z=(0,i.Pi)(u)},79003:function(e,s,a){a.d(s,{v:function(){return c}});var t=a(50229),l=a(68949),i=a(34625),n=a(59795);class r extends n.b{update(e){throw Error("Method not implemented.")}async getById(e){let s=t.a.user.id,a=await this.pb.getList(1,1,{filter:'message = "'.concat(e,'" && user = "').concat(s,'"')});return a.items[0]}async getOne(e){return this.pb.getOne(e,{expand:"user"})}getAll(){throw Error("Method not implemented.")}async delete(e,s){await this.pb.delete(s),console.log("likeService.delete()")}async create(e){let s=await this.getById(e);if(s){let a=s.id;await this.delete(e,a);return}let a={message:e,user:this.user.id};await this.pb.create(a,{expand:"user"}),console.log("likeService.create()")}async subscribe(){let e=await this.pb.subscribe("*",async e=>{let{action:s,record:a}=e,l=t.a.messages.findIndex(e=>e.id==a.message);if(-1==l){i.k.log("likeService.subscribe() message not found",a.message);return}if("delete"!==s){let e=await this.getOne(a.id);this.addLikeOrReplaceToMessage(e,l)}"delete"===s&&(this.filterLikeFromMessage(a,l),console.log("likeService.subscribe(delete)",a))});return e}addLikeOrReplaceToMessage(e,s){let a=t.a.messageLikes[s],i=null==a?void 0:a.findIndex(s=>s.id==e.id);a&&void 0!=i&&(0,l.aD)(()=>{if(-1==i){t.a.messageLikes[s]=[...a,e];return}a[i]=e})()}filterLikeFromMessage(e,s){let a=t.a.messageLikes[s];a&&(0,l.aD)(()=>{t.a.messageLikes[s]=a.filter(s=>s.id!=e.id)})()}}let c=new r("Likes")},21154:function(e,s,a){var t=a(85893);a(67294);var l=a(8189),i=a(26671);let n=e=>{let{language:s,value:a}=e;return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(l.Z,{style:i.FE,language:null!=s?s:void 0,wrapLongLines:!0,showLineNumbers:!0,children:a})})};s.Z=n}}]);