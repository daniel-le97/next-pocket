(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[855],{11658:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/server/[id]",function(){return a(11062)}])},11062:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return em}});var t=a(85893),r=a(9008),n=a.n(r),i=a(67294),l=a(89583),o=a(50828),c=a(63750),d=a(50229),u=a(2059),h=a(45445),m=a(39675),x=a(61528),v=a(87536),g=a(79790);let j=e=>{var s;let{selection:a}=e;d.a.user;let r=null===(s=d.a.activeChannel)||void 0===s?void 0:s.title,n=async()=>{try{let e=d.a.user;if(!e){console.error("must be logged in");return}let s={memberId:null==e?void 0:e.id,channelId:null==a?void 0:a.id};d.a.messages=[],d.a.messageQuery="",await u.b.joinChannel(s),await h.l.getMessagesByChannelId(a.id)}catch(e){console.error(e)}};return(0,t.jsxs)("div",{className:"dropdown-selection  ".concat(a.title===r?"rounded bg-zinc-700 text-gray-300":"text-gray-500"),onClick:n,children:[(0,t.jsx)(c.nvr,{size:"24",className:"text-gray-400"}),(0,t.jsx)("h5",{className:"dropdown-selection-text ",children:a.title}),a.title==r&&(0,t.jsx)("div",{className:"group relative",children:(0,t.jsx)(m.Z,{buttonIcon:(0,t.jsx)(x.ZP,{content:"Edit Channel",color:"invert",className:" font-bold",children:(0,t.jsx)(l.p4t,{size:15})}),title:"Edit Channel",children:(0,t.jsx)(p,{})})})]})},p=()=>{var e,s,a,r;let{register:n,handleSubmit:i,watch:l,setValue:o,reset:c,formState:{errors:h}}=(0,v.cI)({defaultValues:{members:null===(e=d.a.activeChannel)||void 0===e?void 0:e.members,messages:null===(s=d.a.activeChannel)||void 0===s?void 0:s.messages,title:null===(a=d.a.activeChannel)||void 0===a?void 0:a.title,server:null===(r=d.a.activeServer)||void 0===r?void 0:r.id}}),m=async e=>{try{var s;let a=null===(s=d.a.activeChannel)||void 0===s?void 0:s.id;await u.b.updateChannel(a,e)}catch(e){console.error(e)}},x=async()=>{try{var e;let s=await g.Z.confirm();if(!s)return;await u.b.deleteChannel(null===(e=d.a.activeChannel)||void 0===e?void 0:e.id)}catch(e){console.error(e)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("form",{onSubmit:i(m),children:[(0,t.jsx)("label",{className:" block text-sm font-bold text-zinc-300",children:"Channel Title:"}),(0,t.jsx)("input",{className:"my-2",type:"text ",...n("title",{required:!0,minLength:5,maxLength:20})}),(0,t.jsx)("button",{className:"btn-primary",children:" Submit"})]}),(0,t.jsx)("button",{className:"btn btn-secondary mt-2 ",onClick:x,children:"Delete Channel "})]})};var f=(0,o.Pi)(j),b=a(64879),y=a(11163);let N=()=>{let e=d.a.user,s=d.a.activeServer,a=(0,y.useRouter)(),r=async()=>{try{if(!s&&!e){g.Z.error("unable to find server and user ids");return}let t={server:s.id,user:e.id},r=await g.Z.confirm("Leave ".concat(null==s?void 0:s.name),"Are You Sure?","question","Confirm");if(!r)return;await b.C.leaveServer(t),a.push("/"),g.Z.success("left Server")}catch(e){g.Z.error(e)}};return(0,t.jsxs)("button",{className:"server-options-selection",onClick:r,children:["Leave ",(0,t.jsx)("small",{children:s&&s.name})]})};var w=(0,o.Pi)(N),S=a(55726);let C=()=>{let e=(0,y.useRouter)(),s=e.query.id,a=d.a.activeServer,r=d.a.user,n=async()=>{try{let t=await g.Z.confirm();if(!t)return;console.log(null==a?void 0:a.owner,null==a?void 0:a.id),await S.u.DeleteServer(a.owner,s),e.push("/")}catch(e){g.Z.error(e)}};return(0,t.jsx)("div",{className:"w-full",children:(null==r?void 0:r.id)==(null==a?void 0:a.owner)?(0,t.jsxs)("button",{className:" server-options-selection",onClick:n,children:["Delete Server",(0,t.jsx)(l.dIY,{size:15})]}):(0,t.jsx)("div",{className:""})})};var k=(0,o.Pi)(C),P=a(85699);let Z=()=>{var e;let[s,a]=(0,i.useState)(!1),{register:r,handleSubmit:n,watch:o,setValue:c,reset:u,formState:{errors:h}}=(0,v.cI)({defaultValues:{members:[],messages:[],title:"",server:null===(e=d.a.activeServer)||void 0===e?void 0:e.id}}),x=async e=>{try{await P.b_.createChannel(e),u(),a(!1)}catch(e){console.error(e)}};return(0,t.jsx)("button",{className:" server-options-selection",children:(0,t.jsx)(m.Z,{buttonIcon:(0,t.jsxs)("div",{className:"flex w-full  justify-between",children:["Create Channel",(0,t.jsx)(l.EIY,{size:18})]}),title:"Create Channel",children:(0,t.jsxs)("form",{onSubmit:n(x),children:[(0,t.jsx)("input",{className:" ml-0 mr-auto w-full cursor-text rounded-md bg-zinc-800  bg-transparent p-2 font-semibold text-gray-500 placeholder-gray-500 outline-none focus:w-full",type:"text",placeholder:"Enter Title",...r("title",{required:!0,minLength:5,maxLength:30})}),(0,t.jsx)("button",{type:"submit",children:"Submit"})]})})})};var D=(0,o.Pi)(Z);let I=()=>{let e=(0,y.useRouter)(),s=async()=>{let s=window.location.origin?window.location.origin:"",a="".concat(s,"/").concat(e.asPath,"/join");console.log(e,s),await navigator.clipboard.writeText(a),g.Z.toast("Copied To ClipBoard")};return(0,t.jsxs)("button",{className:" server-options-selection",onClick:s,children:["getLink",(0,t.jsx)(l.GON,{size:15})]})};var z=(0,o.Pi)(I);let L=()=>(0,t.jsx)("button",{className:" server-options-selection",children:(0,t.jsx)(m.Z,{buttonIcon:(0,t.jsxs)("div",{className:"flex w-full  justify-between",children:["SearchMembers",(0,t.jsx)(l.U41,{size:22})]}),title:"Search Members",children:(0,t.jsx)("div",{className:"",children:"Lorem ipsum dolor sit amet consectetur, adipisicing elit. Repellat, libero minima nobis eaque eos nemo vel dolore id perspiciatis similique beatae autem doloribus fugit consequatur quidem pariatur labore eum cum."})})});var E=(0,o.Pi)(L);let M=()=>{var e;let[s,a]=(0,i.useState)(!1),{register:r,handleSubmit:n,watch:o,setValue:c,reset:u,formState:{errors:h}}=(0,v.cI)({defaultValues:{members:[],messages:[],title:"",server:null===(e=d.a.activeServer)||void 0===e?void 0:e.id}});return(0,t.jsx)("button",{className:" server-options-selection",children:(0,t.jsx)(m.Z,{buttonIcon:(0,t.jsxs)("div",{className:"flex w-full  justify-between",children:["Server Guidelines",(0,t.jsx)(l.EIY,{size:18})]}),title:"Server Guidelines",children:(0,t.jsx)("div",{className:" p-2 text-white",children:(0,t.jsxs)("ul",{className:" list-decimal",children:[(0,t.jsx)("li",{children:"Respect others: Treat other users with respect and refrain from using offensive language, hate speech, or any form of harassment or discrimination."}),(0,t.jsx)("li",{children:"Stay on topic: Keep conversations relevant to the chat's purpose and refrain from discussing inappropriate or off-topic subjects."}),(0,t.jsx)("li",{children:"No spamming: Do not flood the chat with repetitive messages or advertising, as this disrupts the flow of conversation."}),(0,t.jsx)("li",{children:"No trolling: Do not intentionally disrupt the chat or provoke others with the intention of causing harm or annoyance."}),(0,t.jsx)("li",{children:"Keep it legal: Do not engage in any illegal activities or discuss any illegal topics, as this could result in consequences for the chat and its users."}),(0,t.jsx)("li",{children:"Follow instructions: Follow the guidelines and instructions set by the chat moderators and administrators."}),(0,t.jsx)("li",{children:"No personal information: Do not share personal information, such as phone numbers, addresses, or passwords, in the chat."}),(0,t.jsx)("li",{children:"Keep it clean: Refrain from posting any explicit or inappropriate content that may be offensive or harmful to others."}),(0,t.jsx)("li",{children:"Use appropriate language: Use appropriate language and avoid excessive use of profanity or vulgar language."}),(0,t.jsx)("li",{children:"Report inappropriate behavior: If you witness any inappropriate behavior or content in the chat, report it to the moderators or administrators immediately."})]})})})})};var T=(0,o.Pi)(M),_=a(73560);let q=()=>{var e;let[s,a]=(0,i.useState)(!1);return(0,t.jsxs)("div",{className:"relative ",children:[(0,t.jsxs)("button",{className:"server-options-btn py-[17px]",onClick:()=>a(!s),children:[null===(e=d.a.activeServer)||void 0===e?void 0:e.name,s?(0,t.jsx)(l.ZTc,{}):(0,t.jsx)(l.NWQ,{})]}),s&&(0,t.jsx)(R,{})]})},R=()=>{var e,s;let a=(null===(e=d.a.activeServer)||void 0===e?void 0:e.owner)===(null===(s=d.a.user)||void 0===s?void 0:s.id);return(0,t.jsx)("div",{className:"  server-options ",children:(0,t.jsxs)("div",{className:"server-options-container",children:[(0,t.jsx)(w,{}),a&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k,{}),(0,t.jsx)(D,{})]}),(0,t.jsx)(z,{}),(0,t.jsx)(E,{}),(0,t.jsx)(T,{})]})})};var F=(0,o.Pi)((0,_.k)(q)),U=a(20128);let Q=()=>{let e=d.a.channels,s=d.a.user,[a,r]=(0,i.useState)(!0);return(0,t.jsxs)("div",{className:"channel-bar",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(F,{}),(0,t.jsx)("div",{className:"channel-container",children:(0,t.jsxs)("div",{className:"m-0 w-full px-2 pb-2 transition duration-300 ease-in-out",children:[(0,t.jsxs)("div",{onClick:()=>r(!a),className:"mx-0 flex cursor-pointer flex-row items-center  text-gray-500",children:[(0,t.jsx)(B,{expanded:a}),(0,t.jsx)("h5",{className:a?"text-lg font-bold text-indigo-500 text-opacity-90":"text-gray-500text-opacity-90  cursor-default  text-lg font-semibold",children:"Text Channels"})]}),a&&e&&e.map(e=>(0,t.jsx)(f,{selection:e},e.id))]})})]}),(0,t.jsx)(O,{user:s})]})},B=e=>{let{expanded:s}=e;return s?(0,t.jsx)(l.RiI,{size:"14",className:"chevron-icon "}):(0,t.jsx)(l.Dli,{size:"14",className:"chevron-icon"})},O=e=>{let{user:s}=e,[a,r]=(0,i.useState)(!1),n=()=>{r(!a)};return s&&(0,t.jsxs)("div",{className:"group",children:[(0,t.jsx)("button",{onBlur:n,onFocus:n,className:"user-bar group ",children:(0,t.jsxs)("div",{className:" user-bar-container",children:[(0,t.jsx)(U.Z,{avatarUrl:s.avatarUrl,height:"w-9",width:"h-9"}),(0,t.jsx)("div",{className:" truncate font-semibold  text-white",children:null==s?void 0:s.username})]})}),(0,t.jsxs)("div",{className:"user-modal  ".concat(a?"scale-100":"scale-0"," "),children:[(0,t.jsx)("div",{className:"user-modal-banner"}),(0,t.jsx)("div",{className:"user-modal-user-image",children:(0,t.jsx)(U.Z,{avatarUrl:s.avatarUrl,height:"w-20",width:"h-20"})}),(0,t.jsxs)("div",{className:"mx-2 mt-16  rounded-md p-2 ",style:{backgroundColor:"#111214"},children:[(0,t.jsx)("p",{className:"text-xl",children:null==s?void 0:s.username}),(0,t.jsx)("hr",{className:"my-2  border-gray-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-md font-bold ",children:"MEMBER SINCE"}),(0,t.jsx)("p",{className:"  font-mono text-gray-400  ",children:new Date(s.created).toLocaleDateString()})]}),(0,t.jsx)("hr",{className:"my-2  border-gray-600"}),(0,t.jsx)("div",{className:"",children:"LogOut"})]})]})]})};var K=(0,o.Pi)(Q),V=a(37066);let Y=()=>{let e=d.a.members,[s,a]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let e;return(async()=>{try{e=await P._A.subscribe()}catch(e){g.Z.error(e)}})(),()=>{null==e||e()}},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:s?"m-0  h-auto  w-64 overflow-hidden bg-gray-200 shadow-lg transition-all duration-300 dark:bg-zinc-800   ":" h-0 w-0 cursor-none overflow-hidden bg-zinc-800  opacity-0 transition-all duration-300 ",children:[(0,t.jsxs)("div",{className:"channel-block",children:[(0,t.jsx)("h5",{className:"channel-block-text",children:"Members"}),(0,t.jsxs)("div",{className:" mx-auto my-2 rounded-3xl  text-gray-500",children:[" ",s?(0,t.jsx)(c.PxJ,{size:24,onClick:()=>a(!s),className:"cursor-pointer"}):(0,t.jsx)("div",{className:""})]})]}),(0,t.jsx)("div",{className:" flex flex-col gap-y-3 px-3",children:e&&e.map((e,s)=>(0,t.jsx)("div",{className:"relative cursor-pointer rounded-lg p-2 transition-all duration-200 hover:bg-slate-500",children:(0,t.jsx)(A,{user:e})},s))})]}),!s&&(0,t.jsx)("div",{className:" absolute  right-3   top-2 mx-auto my-2 rounded-3xl   text-gray-500 transition-all duration-200",children:(0,t.jsx)(c.RVs,{size:24,onClick:()=>a(!s),className:"hover:text-green-500 cursor-pointer"})})]})},A=e=>{var s,a,r,n,i,l;let{user:o}=e;return(0,t.jsxs)("div",{className:"user-container flex gap-x-2  ",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(U.Z,{height:"h-8",width:"w-8",avatarUrl:null===(s=o.expand)||void 0===s?void 0:s.user.avatarUrl}),(0,t.jsx)("div",{className:"absolute left-8 top-9",children:o&&(0,t.jsx)(V.Z,{isOnline:null==o?void 0:null===(a=o.expand)||void 0===a?void 0:null===(r=a.user)||void 0===r?void 0:null===(n=r.expand)||void 0===n?void 0:null===(i=n.onlineStatus)||void 0===i?void 0:i.isOnline})})]}),(0,t.jsx)("small",{className:" font-bold text-rose-600",children:null===(l=o.expand)||void 0===l?void 0:l.user.username})]})};var G=(0,o.Pi)(Y),W=a(48699),X=a(47472),H=a(44217),J=a(32483),$=a(68949);let ee=()=>{var e;return(0,t.jsxs)("div",{className:"top-navigation",children:[(0,t.jsx)(l.qc7,{size:"20",className:"title-hashtag"}),(0,t.jsx)("h5",{className:"channel-room-title",children:""===d.a.messageQuery?null===(e=d.a.activeChannel)||void 0===e?void 0:e.title:"Searching Messages Within Server"}),(0,t.jsx)(es,{})]})},es=()=>{let[e,s]=(0,i.useState)(""),[a,r]=(0,i.useState)(!0),n=(0,i.useMemo)(()=>async e=>{let s=await X.pb.collection(H.nW.Messages).getList(1,10,{filter:'content ~ "'.concat(e,'"'),expand:"user,likes(message).user"}),a=s.items;(0,$.aD)(()=>{let e=a.map((e,s)=>{let a=new J.v0(e);return d.a.messageLikes[s]=e.expand["likes(message)"]||[],a});d.a.messages=[...d.a.messages,...e],d.a.totalPages=s.totalPages})()},[]),o=s=>{s.preventDefault(),d.a.messageQuery=e,d.a.messages=[],d.a.page=1,n(e)};return(0,t.jsxs)("form",{onSubmit:o,className:" relative  flex      items-center   justify-start  gap-x-2      ",children:[(0,t.jsx)("input",{className:" pr-10 text-gray-300 transition-all   duration-700 focus:w-72  ".concat(a?"w-full":""),type:"text",placeholder:"Search",value:e,onChange:e=>s(e.target.value)}),(0,t.jsx)("div",{className:"absolute right-2 z-10 ",children:(0,t.jsx)(x.ZP,{content:"Search Message",color:"invert",placement:"bottom",children:(0,t.jsx)("button",{className:"m-0 pt-1 ",children:(0,t.jsx)(l.U41,{size:22,className:"     my-auto text-gray-500 hover:text-green-500 ".concat(""!==e?"text-green-500":"")})})})})]})};var ea=(0,o.Pi)(ee),et=a(79003),er=a(58533),en=a(59719);let ei=()=>{let e,s;async function a(){var e;let s=null===(e=d.a.activeChannel)||void 0===e?void 0:e.id;d.a.page++,await h.l.getMessagesByChannelId(s),console.log("page",d.a.page,"totalPage",d.a.totalPages)}return(0,i.useEffect)(()=>((async()=>{try{e=await h.l.subscribe(),s=await et.v.subscribe()}catch(e){g.Z.error(e,"like or message subscription failed")}})(),()=>{null==s||s(),null==e||e()}),[]),(0,t.jsxs)("div",{id:"scrollableDiv",className:"flex h-full  flex-col-reverse overflow-auto pb-32 pt-6  ".concat(""!=d.a.messageQuery?"rounded-sm border-2 border-indigo-500 shadow-inner  ":" "),children:[d.a.messages.length>=1&&(0,t.jsx)(er.Z,{dataLength:d.a.messages.length,next:a,className:"flex flex-col-reverse pt-6    ",inverse:!0,hasMore:d.a.totalPages!=d.a.page,loader:(0,t.jsx)(el,{}),scrollableTarget:"scrollableDiv",children:d.a.messages.map((e,s)=>{let a=new Date(e.created).toLocaleDateString(),r=new Date(Date.now()).toLocaleDateString(),n=s>0?new Date(d.a.messages[s-1].created).toLocaleDateString():null;return(0,t.jsxs)("div",{children:[(0,t.jsx)(en.Z,{index:s,message:e}),(0,t.jsx)("div",{children:a!==n&&a!==r&&(0,t.jsxs)("div",{className:"new-date",children:[(0,t.jsx)("hr",{className:"w-3/6  opacity-40"}),(0,t.jsx)("div",{className:" new-date-text",children:a}),(0,t.jsx)("hr",{className:"w-3/6  opacity-40"})]})})]},s)})}),""==d.a.messageQuery&&0==d.a.messages.length&&(0,t.jsx)(el,{}),""!=d.a.messageQuery&&0==d.a.messages.length&&(0,t.jsxs)("div",{className:"container w-1/2 rounded  p-3 text-center text-xl text-gray-400",children:["No messages contain",(0,t.jsx)("br",{}),(0,t.jsxs)("div",{className:"font-bold text-gray-200 my-2",children:['"',d.a.messageQuery,'"']}),"Refine Your search"]})]})},el=()=>(0,t.jsx)("div",{className:"fixed inset-0 h-1",children:(0,t.jsx)("div",{className:"relative h-1 w-full overflow-hidden rounded-lg shadow  ",children:(0,t.jsx)("div",{className:"animate-loader   absolute inset-0 bg-gradient-to-r from-indigo-400 to-indigo-500 shadow-md shadow-indigo-500  "})})});var eo=(0,o.Pi)(ei);let ec=()=>{let e=d.a.user,[s,a]=(0,i.useState)(0),{register:r,handleSubmit:n,reset:l}=(0,v.cI)({defaultValues:{content:"",user:e.id,channel:""}}),o=async e=>{try{var s;let t=document.getElementById("createMessageInput");e.channel=null===(s=d.a.activeChannel)||void 0===s?void 0:s.id,await h.l.sendMessage(e),l(),t&&(t.style.height="initial"),a(0)}catch(e){g.Z.error(e)}};return(0,t.jsxs)("div",{className:" absolute  bottom-2  max-h-full w-full  bg-white   pt-10  dark:border-white/20 dark:bg-gray-800 md:border-t-0 md:border-transparent md:!bg-transparent ",children:[(0,t.jsx)("form",{onSubmit:n(o),className:"relative mx-4  flex",children:d.a.activeChannel?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("textarea",{id:"createMessageInput",rows:1,className:"create-message-input max-h-96 w-full resize-none  rounded-xl  bg-zinc-600/90 py-3.5 pl-4 pr-12 text-lg  font-semibold text-zinc-300 focus:outline-none",...r("content",{required:!0,maxLength:1200,minLength:3}),onInput:e=>{e.currentTarget.style.height="auto",e.currentTarget.style.height="".concat(e.currentTarget.scrollHeight,"px"),a(e.currentTarget.value.length),s>=1200&&e.preventDefault()},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),n(o)())}}),(0,t.jsxs)("p",{id:"charLimit",className:" absolute bottom-14 right-2 text-sm  ".concat(s<=1200?"text-zinc-300":"text-red-400"),children:[s,"/1200"]}),(0,t.jsx)("button",{type:"submit",className:"btn-primary absolute bottom-2 right-2 ",children:"Submit"})]}):(0,t.jsx)("div",{className:""})}),(0,t.jsx)("div",{className:"flex items-center justify-evenly"})]})};var ed=(0,o.Pi)(ec),eu=a(44080);let eh=()=>{let e=(0,y.useRouter)(),s=e.query.id,[a,r]=(0,i.useState)(!1),l=async e=>{try{await P.b_.getChannelsByServerId(e),await P.lt.getMessagesByChannelId(d.a.activeChannel.id),await P.uy.getMembers(e)}catch(e){g.Z.error(e)}};return(0,i.useEffect)(()=>{r(!0);let a=d.a.user;if(!a){(0,W.A)("/server/".concat(s)),e.push("/login");return}e.query.id&&l(s)},[e.query.id]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n(),{children:[(0,t.jsx)("title",{children:"next-pocket"}),(0,t.jsx)("meta",{name:"description",content:"Generated by create-t3-app"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsx)(eu.u,{appear:!0,show:a,enter:"ease-out duration-700",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-700",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,t.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-center ",children:(0,t.jsxs)("div",{className:"flex  h-screen w-full  ",children:[(0,t.jsx)(K,{}),(0,t.jsxs)("div",{className:" message-container ",children:[(0,t.jsx)(ea,{}),(0,t.jsx)(eo,{}),(0,t.jsx)(ed,{})]}),(0,t.jsx)(G,{})]})})})]})};var em=(0,o.Pi)((0,_.Q)((0,_.k)(eh)))},48699:function(e,s,a){"use strict";a.d(s,{A:function(){return n},v:function(){return r}});var t=a(50229);let r=()=>{let e=t.a.lastPath;return e||"/"},n=e=>(t.a.lastPath=e,e)},72770:function(e){"use strict";e.exports=next}},function(e){e.O(0,[868,568,774,888,179],function(){return e(e.s=11658)}),_N_E=e.O()}]);